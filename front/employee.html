{% extends "base.html" %}
{% block content %}

<h2 class="text-center text-danger fw-bold mb-4">üë®‚Äç‚öïÔ∏è Employee Management</h2>

<!-- ===================================================== -->
<!--                  ADD EMPLOYEE FORM                    -->
<!-- ===================================================== -->
<div class="card shadow-sm p-4 mb-4 border-0 rounded-4">
    <h4 class="text-danger fw-bold mb-3 text-center">‚ûï Add New Employee</h4>

    <form method="POST" action="/employee">
        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label fw-semibold">Name</label>
                <input type="text" name="E_name" class="form-control" required>
            </div>

            <div class="col-md-6">
                <label class="form-label fw-semibold">Contact</label>
                <input type="number" name="E_contact" class="form-control" required>
            </div>

            <div class="col-md-12">
                <label class="form-label fw-semibold">Address</label>
                <textarea name="E_address" class="form-control" rows="2"></textarea>
            </div>

            <div class="col-md-4">
                <label class="form-label fw-semibold">Age</label>
                <input type="number" name="E_age" class="form-control" required>
            </div>

            <div class="col-md-4">
                <label class="form-label fw-semibold">Designation</label>
                <input type="text" name="E_designation" class="form-control">
            </div>

            <div class="col-md-4">
                <label class="form-label fw-semibold">Experience (Years)</label>
                <input type="number" name="E_experience" class="form-control">
            </div>

            <div class="col-md-6">
                <label class="form-label fw-semibold">Assigned Blood Bank</label>
                <select name="BB1_id" class="form-select" required>
                    <option disabled selected>Select Blood Bank</option>
                    {% for bb in bloodbanks %}
                        <option value="{{ bb[0] }}">{{ bb[1] }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="text-center mt-4">
            <button type="submit" class="btn btn-danger px-5 fw-semibold">Add Employee</button>
        </div>
    </form>
</div>


<!-- ===================================================== -->
<!--                  EMPLOYEE TABLE                       -->
<!-- ===================================================== -->
<h4 class="text-danger fw-bold mb-3 text-center">üìã Employee List</h4>

{% if employees %}
<table class="table table-bordered table-striped shadow-sm text-center align-middle">
    <thead class="table-danger">
        <tr>
            {% for h in headers %}
                <th>{{ h }}</th>
            {% endfor %}
        </tr>
    </thead>

    <tbody>
        {% for e in employees %}
        <tr>
            {% for col in e %}
                <td>{{ col }}</td>
            {% endfor %}
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="alert alert-warning text-center fw-semibold">
    ‚ö† No employees found.
</div>
{% endif %}



<!-- ===================================================== -->
<!--               HOSPITAL ORDERS SECTION                 -->
<!-- ===================================================== -->
<h3 class="text-danger fw-bold mt-5 text-center">ü©∏ Hospital Orders</h3>

{% if orders %}
<table class="table table-bordered table-striped shadow-sm text-center align-middle mt-3">
    <thead class="table-danger">
        <tr>
            {% for h in o_headers %}
                <th>{{ h }}</th>
            {% endfor %}
            <th>Invoice</th>
        </tr>
    </thead>

    <tbody>
        {% for o in orders %}
        <tr>
            {% for col in o %}
                <td>{{ col }}</td>
            {% endfor %}

            <td>
                {% if o[6] != "Invoiced" and o[6] != "Completed" %}
                <form method="POST" action="/create_invoice" class="d-inline">
                    <input type="hidden" name="Or_id" value="{{ o[0] }}">
                    <button class="btn btn-sm btn-warning">üßæ Generate Invoice</button>
                </form>
                {% else %}
                    <span class="badge bg-success">‚úî Invoice Done</span>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="alert alert-warning text-center fw-semibold">
    ‚ö† No hospital orders found.
</div>
{% endif %}


<div class="text-center mt-4">
    <a href="/appointments" class="btn btn-outline-dark px-5 py-2 mx-2">‚¨Ö Appointments</a>
    <a href="/admin" class="btn btn-danger px-5 py-2 mx-2">Admin Dashboard ‚ûú</a>
</div>

{% endblock %}
